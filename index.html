<!doctype html>
<html lang="en">

<head>
<meta charset="utf-8">

<title>Unretrofittable: Starting projects off right</title>

<meta name="description" content="Presentation from Pittsburgh Techfest 2014">
<meta name="author" content="Chris Winters">

<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<link rel="stylesheet" href="css/reveal.min.css">
<link rel="stylesheet" href="css/theme/sky.css" id="theme">

<!-- For syntax highlighting -->
<link rel="stylesheet" href="lib/css/zenburn.css">

<!-- If the query includes 'print-pdf', include the PDF print sheet -->
<script>
  if( window.location.search.match( /print-pdf/gi ) ) {
    var link = document.createElement( 'link' );
    link.rel = 'stylesheet';
    link.type = 'text/css';
    link.href = 'css/print/pdf.css';
    document.getElementsByTagName( 'head' )[0].appendChild( link );
  }
</script>

<!--[if lt IE 9]>
<script src="lib/js/html5shiv.js"></script>
<![endif]-->
</head>

<body>

<div class="reveal">

  <!-- Any section element inside of this container is displayed as a slide -->
<div class="slides">
  <section>
    <h1>Unretrofittable: Starting off right</h1>
    <h3>Some abstractions are hard to (un|re)do...</h3>
    <p>
      Chris Winters (@cwinters)
    </p>
    <p>
      Pittsburgh Techfest 2014
    </p>
  </section>

  <section>
    <h2>Things start out great</h2>
    <p>
      Greenfield projects are the <b>best</b>, right?
    </p>
    <aside class="notes">
Starting a new project is one of my favorite things. So many things to
play with, so much to discover.
    </aside>
  </section>

  <section>
    <img src="lib/images/charlie_bucket_with_golden_ticket.jpg" />
    <aside class="notes">
Gift to work on new. Audience Q: How many in last year? Every?
New/rewritten subsystem?
    </aside>
  </section>

  <section>
    <h2>It all made sense at the time</h2>

    <aside class="notes">
Why? No usual mistakes - toubling bugs, difficult users, interface
with terrible, compromises, dreadful assumptions, hidden agendas...
<br />
Many are good ideas at the time! Nobody wants crap -- just
willing to trade off for it.
    </aside>
  </section>

  <section>
    <img src="lib/images/oh_my_ive_done_it_again.jpg" />

    <aside class="notes">
I will do them all. You will too. And I'll forget all these lessons
because NEW SYSTEM.
    </aside>
  </section>

  <section>
    <h2>Does it matter why?</h2>
    <img src="lib/images/tumbleweed_blowing.gif" />

    <aside class="notes">
Lots of reasons, that's another talk. Now: our levels of abstraction,
side effects of working with right and wrong ones.
    </aside>

  </section>

  <section>
    <h2>"agile" vs AGILE</h2>
    <img src="lib/images/au_lapin_agile.jpg" />

    <aside class="notes">
We love "agile", maybe not Agile. Lot of it geared toward making
developer acutely aware of all joy + pain, tightening feedback between
awareness and influence on them.
    </aside>
  </section>

  <section>
    <h2>Frying pan?</h2>
    <img src="lib/images/au_lapin_agile_rabbit.jpg" />
    <aside class="notes">
You probably didn't sign up for people feedback loops, right? We have
analysts and product manager to take care of these things, right?
<br />
Nope, you're FULL STACK, baby. That includes the user.
    </aside>
  </section>

  <section>
    <h2>What is your job?
    <h3 class="fragment" data-fragment-index="1">Help others be awesome</h3>
    <p class="fragment" data-fragment-index="2">...what we do is a means, not an end</p>

    <aside class="notes">
Hard to remember -- the means is fun! Argue about editors and
frameworks! But the end is what we get paid for.
    </aside>
  </section>

  <section>
    <h2>Change as change does</h2>
    <img src="lib/images/spiders_from_cocoon.jpg" />

    <aside class="notes">
Biology definition of "stable". We create complex systems.
<br />
Main technical lever: easy to change.
<br />
...increases opportunity for empathy. Common theme at devopsdays last
week -- with co-workers, other organization parts, mostly with users.
    </aside>
  </section>

  <section>
    <h2>Empathy with what?</h2>

    <aside class="notes">
Role of our systems in work / life
<br />
More: what they DO. Leads to assertion: Focus on tasks as organizing
abstraction will make your system better at what it does.
<br />
Thinking about tasks user POV not only happier users, clarity on new
feature focus.
    </aside>
  </section>

  <section>
    <h2>Side effects</h2>

    <aside class="notes">
Sometimes the main benefit, sometimes a risk or something to be mitigated,
and sometimes can lead to other side effects or enable other practices.
    </aside>
  </section>

  <section>
    <img src="lib/images/bees_colliding.gif" width="800" height="454" />
    <aside class="notes">
      Take a drink!
    </aside>
  </section>

  <section>
    <h2>Lever 1: Creating a usable system</h2>

    <p>One command to create a system with real(-ish) data.</p>
  </section>

  <section>
    <img src="lib/images/skepticalbaby.jpg" />

    <aside class="notes">
Seriously! Everybody ignores. Happy to limp along with data we've built up.
<br />
Show system to family: data real? real life user names? products have
generic photos? history -- was everything created the same day?
    </aside>
  </section>

  <section>
    <h2>Hard part: real(-ish)</h2>
    <p class="fragment" data-fragment-index="1">"But I have fixtures!"</p>
    <img class="fragment" data-fragment-index="2" src="lib/images/wat_emu.jpg" />

    <aside class="notes">
One command is easy. Hard part is looking real. Oh, you have fixtures...?
    </aside>
  </section>

  <section>
    <h2>Can your domain experts edit them?</h2>
    <aside class="notes">
Fixtures are bare minimum. Write once read never. Relational data
without SQL is awful. In YAML files? LOL
<br />
They work table by table. Because objects mapped to tables,
data flow directly into them.
<br />
THIS SHOWS THE PROBLEM.
    </aside>
  </section>

  <section>
    <h2>Abstractions shape ideas</h2>

    <img src="lib/images/many_tables.jpg" />

    <aside class="notes">
Storage shapes thinking and presenting. How many tools do we have to
navigate this path? How many apps have you seen that barf relations to
user?
<br />
"They just make it easy" is problematic. People do what's easy.
    </aside>

  </section>

  <section>
    <h2>So many forms</h2>

    <img src="lib/images/wall_of_clipboards.jpg" />

    <aside class="notes">

Example: hospital discharge nurse. Discharge is A Thing to her. To
you? One or two dozen tables. How to make that real?
<br />
How can you hope to rope domain experts like her into defining your
data for you?
    </aside>
  </section>

  <section>
    <h2>Thinking in tasks</h2>

    <aside class="notes">
Users don't think in normalized tables. Don't care about
efficiency, or query planners.
<br />
Do care about duplication, but less than you think. Do care about
completeness, doing very little mapping their brain to The System.
<br />
We mediate between tasks and metal. We focus on metal. Should foxus on
tasks.  Metal is what we read, argue about, school for, care about.
    </aside>
  </section>

  <section>
    <h2>Tasks will cause you pain</h2>

    <p class="fragment" data-fragment-index="1">Fowler: "If it hurts, do it more often."</p>

    <aside class="notes">
This pain is good! Data too complex and hard to recreate give pain
early. Should be a pointer to your goals. Ideal world pain will induce
change, most often we callus up.
    </aside>
  </section>

  <section>
    <h2>Side effects, you</h2>
    <p class="fragment" data-fragment-index="1">
      Quick startup for new hires or changing teams. Which means
      people can change teams more often!
    </p>
    <p class="fragment" data-fragment-index="2">
      Head off model drift and too-generic data models
    </p>
  </section>

  <section>
    <h2>Side effects, others</h2>
    <p class="fragment" data-fragment-index="1">
      Domain experts define and maintain data
    </p>
    <p class="fragment" data-fragment-index="2">
      Sales + marketing can create and customize demos
    </p>
    <p class="fragment" data-fragment-index="3">
      Potential users can create demos with their own data (woo cloud!)
    </p>
  </section>

  <section>
    <img src="lib/images/supercut_eyeglance_sideways.gif" width="864" height="454" />
    <aside class="notes">
      Take a drink!
    </aside>
  </section>

  <section>
    <h2>Lever 2: Audit</h2>
  </section>

  <section>
    <img src="lib/images/skepticalbaby.jpg" />
    <aside class="notes">
Seriously?! There aren't many terms that evoke enterprise software
more than "auditing".
<br />
TURNS OUT auditing has great first and second-order effects to make
lots of people (including you) happy.
    </aside>
  </section>

  <section>

    <h2>Why do you even?</h2>
    <img src="lib/images/nature_trail_eye_play.jpg" />

    <aside class="notes">
Answer "How did this thing get this way?" at any time. Who created it
with what data, who updated it and when? Can be invaluable for support
staff, though reciting back to a user her actions may be Big Brother
    </aside>
  </section>

  <section>
    <h2>Cooler than it sounds</h2>
    <p>Users love this (mostly), support staff <b>adore</b> it</p>

    <aside class="notes">
To outsiders: you're adding determinism. Crazy system finally MAKES
SENSE. Not just a bunch of people guessing or shrugging and offering
no help.
    </aside>
  </section>

  <section>
    <h2>More abstractions</h2>
    <img src="lib/images/tables_with_view.jpg" />
    <aside class="notes">
Most frameworks hook into persistence. Attractive: leveraging tool for
orthogonal concern -- a big reason we use frameworks!
    </aside>
  </section>

  <section>
    <h2>Refactoring resistant</h2>

    <aside class="notes">
Can work ok, but resist refactoring. How to represent *logical* record
when history is tied to *physical* record and physical storage changed?
    </aside>
  </section>

  <section>
    <h2>X changes Y changes Z changes...</h2>

    <aside class="notes">
Tricky to separate audited actions from side effects - for example:
Amazon gift card needs to + $ in cart, but also - $ from record. And
what if I only use part of the gift card and Amazon has to store the
remainder for later?
    </aside>
  </section>

  <section>
    <h2>Record tasks, not results</h2>

    <aside class="notes">
Traditional auditing: record results. What if we record actions
themselves?  Similar loding data: reuse those ideas and attach 'who'
and 'when' and 'from where' metadata about these actions.
    </aside>
  </section>

  <section>
    <h2>What could we do with that record?</h2>

    <aside class="notes">
Not only auditing, but replay. Replay for load, replay for modified
business logic, replay for debugging to get back to a point in
time. Maybe replay done elsewhere to run through an expensive
computation (risk profile) -- see Fowler's article on LMAX.
    </aside>
  </section>

  <section>
    <h2>Other side effects</h2>

    <p>Confidence in the system: things can be explained!</p>

    <p>Exposing intent -- <tt>RecoverPassword</tt>
    vs <tt>ResetPassword</tt>
    and <tt>SendPasswordRecoveryEmail</tt></p>
  </section>

  <section>
    <h2>Lever 3: Undo</h2>
    <img src="lib/images/keep_calm_and_click_undo.jpg" />
    <aside class="notes">
Lastly, we'll focus on an activity that's almost entirely end-user
focused. Undo.
    </aside>
  </section>

  <section>
    <img src="lib/images/baby_fight.jpg" width="540" height="374" />
    <aside class="notes">
Users have come to expect undo at the small scale, but not at the
large. So undoing a font change or typing should just be there.
<br />
But being able to undo an order placement, or a hospital admission, or
an import of a full school of students...
<br />
That's just magic. The sort of magic that users will LOVE YOU
for. People flip out that they can undo gmail deletions. What if they
accidentally import a spreadsheet of 500 students to the wrong school?
    </aside>
  </section>

  <section>
    <h2>Again with the tasks</h2>
    <aside class="notes">
Users expect undo at the action level and don't care about side
effects in your system. Undo should mean it's like the action never
happened. The form went in the shredder, the upload never happened.
<br />
There are tricks to doing this, and they depend on the type of
action. Both are far easier to implement at the beginning.
    </aside>
  </section>

  <section>
    <h2>Grace period</h2>
    <p>Wait a while to do your work, don't do it if asked</p>
    <aside class="notes">
I place an order, but I can cancel that order without consequence in
the half hour after it's been placed. (Efficiencies in logistics can
actually make this more difficult, ask Amazon.)
<br />
On the surface this may seem simple -- just do nothing until the grace
period is up -- I like solutions where we do nothing!
    </aside>
  </section>

  <section>
    <h2>No free lunch</h2>
    <img src="lib/images/hedgehog_trying_to_escape_top_hat.gif" />
    <aside class="notes">
But in reality you want to do everything EXCEPT the final action. For
example, you need to ensure your validation logic still fires because
you don't want the user to submit the order and walk away only to get
a "Your order is invalid" email a half hour later. This might be
tricky because validation logic may depend on some of the data being
persisted. (Transactions may fix that... as long as you can depend on
them and they're used consistently.)
<br />
None of this is impossible, just easier if you have it in mind from
the beginning
    </aside>
  </section>

  <section>
    <h2>Change as Commands</h2>
    <p>Represent change as commands, represent undone change as commands</p>
    <aside class="notes">
You've already created an abstraction for the user task so you've got
a great handle to undo that task. For commands that touch a lot of
records you'll have to associate them all, but again -- you've
probably already done __that__ because you want to re-display the
original task as the user entered it.
    </aside>
  </section>

  <section>
    <h2>Side effects</h2>
    <p>So much happiness!</p>
    <img src="lib/images/cat_jamming_on_headphones.gif" width="560" height="540" />
  </section>

  <section>
    <h2>Lever n: Feature flags</h2>

    <p><b>Compile/build</b> setting controlling feature
    accessibility</p>

    <aside class="notes">
      Compile/build is typical, not mandated; it speaks more to their
      typical scope.
      <br />
      <br />
      Who's using them?
    </aside>
  </section>

  <section>
    <h2>Why?</h2>

    <aside class="notes">
      Timing features to releases is harder than you'd think,
      particularly the older and larger your system gets. (Yes, this
      is a good argument for lots of small systems. That's another
      talk.)
    </aside>
  </section>

  <section>
    <img src="lib/images/daily_wtf_dependency_graph.png" />

    <aside class="notes">
Dependencies usually aren't this bad (crazy graph), but they can be
tricky. Feature X may require an update to a database table but
Feature Y also needs to update it, and the updates need to be done at
the same time.

BUT Feature X needs to be one two weeks before Feature Y.
    </aside>
  </section>

  <section>
    <h2>Thinking differently about features</h2>

    <p>Full functionality vs not breaking</p>

    <aside class="notes">
Instead of thinking of features as a discrete set of files
implementing a feature that get delievered (sorry, "merged") at once,
what if it were a set of changes that get delivered over time -- maybe
even a long time -- but none of which break existing functionality?
    </aside>
  </section>

  <section>
    <h2>Not the prettiest...</h2>
    <img src="lib/images/old_light_switches.jpg" />

    <aside class="notes">
      Most implementations can be kind of gross... See Kellan
      Elliott-McCrea's presentation on Change at Etsy for an
      example. (PHP, but still...)
    </aside>
  </section>

  <section>
    <h2>I'll just code that up...</h2>
    <p>You don't have to! (Flip, Setler, Togglz)</p>

    <aside class="notes">
      May even be able to use third party runtime A/B testing services
      for lightweight version.
    </aside>
  </section>

  <section>
    <h2>But I want clean!</h2>
    <aside class="notes">
      Having part of a feature's code released is okay! (Koan: is a
      feature even partially released if it cannot be used?)
    </aside>
  </section>

  <section>
    <h2>Side effects++</h2>

    <p>Release more often; A/B testing</p>

    <img src="lib/images/happy_chopsticks_eater.gif" width="418" height="360" />

    <aside class="notes">
      Releasing more often is good in and of itself. But it also means
      you're releasing smaller changes, which are generally less
      risky. Lowered risk increases development experimentation. And
      that can bubble up the organization in great ways.
    </aside>
  </section>

  <section>
    <h2>Related: Kill switch</h2>

    <img src="lib/images/emergency_stop.jpg" width="800" height="600"/>

    <aside class="notes">
      Who's using these?
    </aside>
  </section>

  <section>
    <h2>You might also know me...</h2>

    <p><b>Runtime</b> flag removing functionality due to
    disruption, planned or not</p>

    <aside class="notes">
      Credit card processor went down, some backend system has
      collapsed and we don't want to continue throwing traffic at it,
      etc. Results can be reduced functionality, or may even be hidden
      to user -- for exaample, orders are put into a queue and not
      touched but we can catchup later.
    </aside>
  </section>

  <section>
    <h2>Wouldn't read-only be nice?</h2>

    <p><b>Why?</b> Enabling schema change for broken databases</p>

    <aside class="notes">
      This could help you work around database shortcomings (MySQL
      5.5, how do substantial systems use this!?) by ensuring that you
      can keep your app up during blocking schema changes.
    </aside>
  </section>

  <section>
    <h2>Side effects</h2>

    <p>
      <b>&lt;discuss&gt;</b>What actually happens when things
      fail?<b>&lt;/discuss&gt;</b>
      <br />
      vs
      <br />
      <img src="lib/images/shrug.png" />
    </p>

    <aside class="notes">
      Most of the time these discussions are much better handled by
      other parts of the business, not you. Giving an easily
      understood hook into the ability to turn things off leads to
      discussions of what we should actually do when they're off.
    </aside>
  </section>

  <section>
    <h1>Thank you!</h1>
    <img src="lib/images/egon_eyebrows_closes_door.gif" width="660" height="548" />
  </section>

  <section>
    <h3>Photos</h3>

    <ul>
      <li><a href="https://www.flickr.com/photos/auselen/4155725406">Au Lapin Agile</a> (<a href="https://creativecommons.org/licenses/by-sa/2.0/">cc by-sa</a>)</li>
      <li><a href="https://www.flickr.com/photos/ox4photos/7355535046/">Au Lapin Agile (rabbit closeup)</a> (<a href="https://creativecommons.org/licenses/by-nc-sa/2.0/">cc by-nc-sa</a>)</li>
      <li><a href="https://www.flickr.com/photos/dumbledad/3225255407">Emergency Stop Button</a>  (<a href="https://creativecommons.org/licenses/by/2.0/">cc by</a>)</li>
      <li><a href="https://www.flickr.com/photos/leigh49137/12659520594">Keep calm and click undo</a> (<a href="https://creativecommons.org/licenses/by-nc-sa/2.0/">cc by-nc-sa</a>)</li>
      <li><a href="https://www.flickr.com/photos/k-peters/2941835302">Light trails (in Hong Kong)</a> (<a href="https://creativecommons.org/licenses/by-nc-nd/2.0/">cc by-nc-nd</a>)</li>
      <li><a href="https://www.flickr.com/photos/stefanointintoli/9996084176">Many Tables</a> (<a href="https://creativecommons.org/licenses/by-nd/2.0/">cc by-nd</a>)</li>
      <li><a href="https://www.flickr.com/photos/viamoi/3450521306">Nature Trail Eye Play</a> (<a href="https://creativecommons.org/licenses/by-nc-nd/2.0/">cc by-nc-nd</a>)</li>
      <li><a href="https://www.flickr.com/photos/paulcross/4333070249">Old Light Switches</a> (<a href="https://creativecommons.org/licenses/by/2.0/">cc by</a>)</li>
      <li><a href="https://www.flickr.com/photos/photophilde/2518101974">Spiders leaving the cocoon</a> (<a href="https://creativecommons.org/licenses/by-sa/2.0/">cc by-sa</a>)</li>
      <li><a href="https://www.flickr.com/photos/theo_reth/8477010686/">Tables with view</a> (<a href="https://creativecommons.org/licenses/by-nc-nd/2.0/">cc by-nc-nd</a>)</li>
      <li><a href="https://www.flickr.com/photos/pochateca/29142320/">Wall of clipboards</a> (<a href="https://creativecommons.org/licenses/by-nc-sa/2.0/">cc by-nc-sa</a>)</li>
    </ul>

<!--
      <li><a href="https://www.flickr.com/photos/schinkerj/3865922295">Zebras</a> (<a href="https://creativecommons.org/licenses/by-nc-sa/2.0/">cc by-nc-sa</a>)</li>
Star Trails over Greith - https://www.flickr.com/photos/herbraab/7905545644 - by-nc-nd
LaBarge Creek from Boulder Canyon Trail - https://www.flickr.com/photos/alanenglish/3134513172 - by-nc
-->
  </section>

  <section>
    <h2>References</h2>

      <ul>
        <li>Daily WTF (crazy graph)
      - <a href="http://thedailywtf.com/Articles/The-Enterprise-Dependency.aspx">The
      Enterprise Dependency</a></li>

        <li>David Copeland,
      <a href="http://www.naildrivin5.com/blog/2013/06/16/production-is-all-that-matters.html">"Production is all that matters"</a></li>

        <li>Kellan Elliott-McCrea,
      <a href="http://www.infoq.com/presentations/Etsy">Optimized for Change, Architecture at Etsy</a></li>

        <li>
          Martin Fowler,
          <a href="http://martinfowler.com/bliki/FeatureToggle.html">Feature Toggle</a>;
          <a href="http://martinfowler.com/bliki/FrequencyReducesDifficulty.html">Frequency Reduces Difficulty</a>;
          <a href="http://martinfowler.com/articles/lmax.html">LMAX</a>;
          <a href="http://martinfowler.com/eaaDev/EventSourcing.html">Event Sourcing</a>
          is quite meaty and has lots of other pointers to things
          like
          <a href="http://martinfowler.com/eaaDev/ParallelModel.html">Parallel Model</a>
          and
          <a href="http://martinfowler.com/eaaDev/RetroactiveEvent.html">Retroactive Event</a>
        </li>

        <li>Michael Nygard,
          <a href="http://amazon.com/Release-It-Production-Ready-Pragmatic-Programmers/dp/0978739213/">Release It!</a></li>

        <li>Adam Wiggins, <a href="http://12factor.net/">Twelve-factor app</a></li>
      </ul>
    </section>

</div>

</div>

<script src="lib/js/head.min.js"></script>
<script src="js/reveal.min.js"></script>

<script>

  // Full list of configuration options available here:
  // https://github.com/hakimel/reveal.js#configuration
  Reveal.initialize({
    width: 1280,
    height: 800,
    controls: true,
    progress: true,
    history: true,
    center: true,

    theme: Reveal.getQueryHash().theme, // available themes are in /css/theme
    transition: Reveal.getQueryHash().transition || 'default', // default/cube/page/concave/zoom/linear/fade/none

    // Parallax scrolling
    // parallaxBackgroundImage: 'https://s3.amazonaws.com/hakim-static/reveal-js/reveal-parallax-1.jpg',
    // parallaxBackgroundSize: '2100px 900px',

    // Optional libraries used to extend on reveal.js
    dependencies: [
      { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
      { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
      { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
      { src: 'plugin/zoom-js/zoom.js', async: true, condition: function() { return !!document.body.classList; } },
      { src: 'plugin/notes/notes.js', async: true, condition: function() { return !!document.body.classList; } }
    ]
  });

</script>

</body>
</html>
